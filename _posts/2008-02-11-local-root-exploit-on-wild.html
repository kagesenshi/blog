---
layout: post
title: local root exploit in the wild!!!
date: '2008-02-11T11:08:00.000+08:00'
author: izhar firdaus
tags:
- Security
- PlanetFedora
- Fedora
- Announcement
modified_time: '2011-10-07T12:36:51.063+08:00'
blogger_id: tag:blogger.com,1999:blog-28371165.post-6763534456698688972
blogger_orig_url: https://blog.kagesenshi.org/2008/02/local-root-exploit-on-wild.html
---

<a href="https://www.redhat.com/archives/fedora-list/2008-February/msg01215.html">https://www.redhat.com/archives/fedora-list/2008-February/msg01215.html</a><br /><br /><a href="https://bugzilla.redhat.com/show_bug.cgi?id=432229">https://bugzilla.redhat.com/show_bug.cgi?id=432229</a><br /><br />Affected kernels: 2.6.17 till 2.6.24<br /><br />I tried it on my boxes, and heres the result<br /><br /><b>Hoshino</b><br />Release: Werewolf<br />SELinux: Enforcing<br />Result : <b>R00TED!</b><br /><code><br />[kagesenshi@Hoshino tmp]$ ./a.out <br />-----------------------------------<br /> Linux vmsplice Local Root Exploit<br /> By qaaz<br />-----------------------------------<br />[+] mmap: 0x0 .. 0x1000<br />[+] page: 0x0<br />[+] page: 0x20<br />[+] mmap: 0x4000 .. 0x5000<br />[+] page: 0x4000<br />[+] page: 0x4020<br />[+] mmap: 0x1000 .. 0x2000<br />[+] page: 0x1000<br />[+] mmap: 0xb7f95000 .. 0xb7fc7000<br />[+] root<br />[root@Hoshino tmp]# uname -a<br />Linux Hoshino.KageSenshi.Org 2.6.23.9-85.fc8 #1 SMP Fri Dec 7 15:49:59 EST 2007 i686 i686 i386 GNU/Linux<br /></code><br /><br /><br /><b>Hikari</b><br />Release: Rawhide<br />SELinux: Permissive<br />Result : Safe (I think)<br /><code><br />[izhar@hikari tmp]$ ./a.out <br />-----------------------------------<br /> Linux vmsplice Local Root Exploit<br /> By qaaz<br />-----------------------------------<br />[+] mmap: 0x0 .. 0x1000<br />[+] page: 0x0<br />[+] page: 0x20<br />[+] mmap: 0x4000 .. 0x5000<br />[+] page: 0x4000<br />[+] page: 0x4020<br />[+] mmap: 0x1000 .. 0x2000<br />[+] page: 0x1000<br />[+] mmap: 0xb7f61000 .. 0xb7f93000<br />Segmentation fault<br />[izhar@hikari tmp]$ uname -a<br />Linux hikari.kagesenshi.org 2.6.24-23.fc9 #1 SMP Wed Feb 6 11:36:31 EST 2008 i686 i686 i386 GNU/Linux<br /></code><br /><br />I just refreshed the bugzilla page, and it seems like fixes are on the way to all F7, F8, Rawhide users.<br /><br /><blockquote><br /><b>Comment #9 From Mark J. Cox (Security Response Team) on 2008-02-10 16:05 EST</b><br /><br />So to fix this you need 2.6.24.1 + <br /><a href="http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=712a30e63c8066ed84385b12edbfb804f49cbc44">http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=712a30e63c8066ed84385b12edbfb804f49cbc44</a><br /><br />or if backporting, an earlier kernel plus both<br /><a href="http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=8811930dc74a503415b35c4a79d14fb0b408a361">http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=8811930dc74a503415b35c4a79d14fb0b408a361</a><br />and<br /><a href="http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=712a30e63c8066ed84385b12edbfb804f49cbc44">http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=712a30e63c8066ed84385b12edbfb804f49cbc44</a><br /><br /><b>Comment #10 From Chuck Ebbert on 2008-02-10 22:26 EST</b><br /><br />Fixed in:<br /><br />kernel-2.6.24.1-28.fc9<br />kernel-2.6.23.15-137.fc8<br />kernel-2.6.23.15-80.fc7<br /></blockquote><br /><br />Great and Thanks!!!. Those who are hosting a multiuser system, update your kernels now!.<div class="blogger-post-footer"><br/>
<br/>
- Izhar Firdaus -</div>