---
author: kagesenshi
blogger_id: tag:blogger.com,1999:blog-28371165.post-4408289766903267401
blogger_orig_url: https://blog.kagesenshi.org/2008/04/12-yum-tips-and-tricks.html
categories:
- old blog
date: '2008-04-01T11:30:00.005+08:00'
layout: post
modified_time: '2011-10-07T12:36:50.879+08:00'
tags:
- Linux
- PlanetFedora
- Python
- Open Source
- Fedora
- Hacks
- HOWTO
title: 12 YUM Tips and Tricks
---

YUM Update Manager is the default package manager used in Fedora and Fedora derivatives. It is written in Python and have tonnes of features which average Joe might not know about. These additional features helps a lot on maintaining your system, improving your experience using the package manager and become more productive. Granted, yum depsolving and querying is quite slow compared with APT, but the flexibility and power yum grant to its users, its worth it.<br /><br />To my comrade, <a href="http://linux.byexamples.com">Surface</a>, here, as you requested.<br /><br /><b>Tips 1: Fastest Mirror</b><br /><br />This is usually the very first yum plugin I install in a new Fedora deployment. What does it do?, well, the name tell it all. The plugin will time all the servers in the replied mirrorlist from <a href="http://mirrors.fedoraproject.org">mirrors.fedoraproject.org</a>, and pick the one which is the fastest for you. Everything is done automagically, and considering its a YumCore class of plugin, it works with whatever GUI you use for yum.<br /><br />To install this plugin, use<br /><br /><code>yum install yum-fastestmirror</code><br /><br />Unlike APT which you had to pick the fastest mirror yourself, yum handles this more elegantly<br /><br />The plugin, after it has checked which server is the fastest, it will store a metadata in /var/cache/yum/timedhosts.txt . That metadata will expire after some time. However, if somehow, the cached timedhosts are no longer fast, you can easily force yum to recheck for fastestmirror by deleting that file.<br /><br /><b>Tips 2. Security Only Update</b><br /><br />This tips helps a lot for users who can't keep up with Fedora updates. Fedora is well known for its very fast updating "updates" repository. Things get old quite fast in Fedora. Some people however, are afraid of updating their system to the latest updates packages, mainly because sometimes, these updates, suddenly break stuff as Fedora updates are not backport of fixes but rather moving forward to a newer version. One way to get around this overly sized and numbered updates is by only updating the system with security updates. Theres a plugin for yum for this purpose, and you can install it through<br /><br /><code>yum install yum-security</code><br /><br />To use this plugin to update your computer to the latest security fixes, just use<br /><br /><code>yum --security update</code><br /><br />I have a detailed post about this plugin <a href="http://blog.kagesenshi.org/2008/03/keep-fedora-less-moving-using-yum.html">here</a><br /><br /><b>Tips 3: Presto</b><br /><br />If you are on a budget internet connection with very limited bandwidth, yum-presto is for you. The presto plugin will download deltarpms, which are the changes of the current version installed in your computer and the one on the internet. This will drastically reduce your download size and you can get your updates faster.<br /><br />Work is being done to integrate Presto to Fedora's base repositories, however, the developers are still facing problem trying to integrate Presto with Koji and Bodhi, the buildsystem and the updates pushing system of Fedora. Therefore you will need to configure Presto after installation by following the details at <a href="http://fedorahosted.org/presto/">http://fedorahosted.org/presto/</a><br /><br />To install this plugin, use:<br /><br /><code>yum install yum-presto</code><br /><br /><b>Tips 4: Do NOT Mix Repositories!</b><br /><br />Mixing repositories .. is BAD. There are a lot of repositories out there for you to choose from if you google enough. However, these repositories doesn't necessarily compatible with Fedora base repositories or between each other. I would only recommend users to install only <a href="http://rpm.livna.org">Livna</a> and small repositories which provide a small number of packages like Adobe Linux flash repository or Google's Apps repositories. Livna is the best because of their packages follow closely with Fedora's Packaging Guideline, so, you can expect that their quality of packages are as good as the real thing.<br /><br />Good news that <a href="http://rpm.livna.org">Livna</a>, <a href="http://freshrpms.net">Freshrpms</a> and <a href="http://dribble.co.uk">Dribble</a> are merging to form <a href="http://rpmfusion.org">RPMFusion</a>. Until RPMFusion is launched, just stick with Livna.<br /><br /><b>Tips 5: Broken dependencies? Skip them</b><br /><br />Once you start installing 3rd party repositories, broken dependencies is a risk you will need to take on. This usually happens when the base repository and the 3rd party repository's packages are not in sync with each other. There is a yum plugin to help you automatically skip these broken dependencies together with packages which are affected by it. Its called yum-skipbroken. In rawhide F9, skip-broken have been merged with the core yum. I am not sure about F8.<br /><br />To use it, just use the --skip-broken option parameter on the command line.<br /><br /><code>yum --skip-broken update</code><br /><br />If the option is not available for your Fedora installation, try installing the plugin through<br /><br /><code>yum install yum-skipbroken</code><br /><br /><b>Tips 6: Using proprietary drivers? lock your Xorg and Kernel version!</b><br /><br />This plugin is very useful for users who are using proprietary drivers or kernel modules and would like certain packages to remain as it is to avoid breaking the drivers. I found this useful when I installed Fedora in a friend's computer and he/she needed to use a proprietary driver. I would lock his/her kernel and xorg from upgrading (yes, somehow this approach feels ugly, but it helps preventing them away from updating things which might break the driver)<br /><br />To install, use:<br /><br /><code>yum install yum-versionlock</code><br /><br />Documentation on how to use it is available in /usr/share/doc/yum-versionlock-%{version}/README<br /><br /><b>Tips 7: Keep the cache for future use</b><br /><br />Yum by default does not keep it cached downloads. You can change this behaviour through editing the yum config and change keepcache=1. <br /><br />The yum cache directory, /var/cache/yum can be useful if you are going to play around a lot to the point that you might need to reinstall you Fedora installation frequently. It helps saving some time to redownload all those packages all over again. Just copy the rpm packages in that directory out, and you can reuse it later. You can also create a repository out of it using createrepo.<br /><br /><b>Tips 8: For organizations, create local mirrors!</b><br /><br />It easy to create local mirrors for YUM repositories. There are several way of doing it - Rsync, or reposync (provided by yum-utils package). In normal situation I would recommend using rsync, but for poor me who in a college that blocks rsync, I uses reposync. Reposync downloads through http, but a bit harder to use to setup a usable repository.<br /><br />A documentation on how to start contributing as a mirror is available here: <a href="http://fedoraproject.org/wiki/Infrastructure/Mirroring">http://fedoraproject.org/wiki/Infrastructure/Mirroring</a>.<br /><br />After you've get your mirror synced, get yourself a Fedora Account, and register yourself with Fedora's MirrorManager. The beauty here is, from the MirrorManager, you can set, for example, any requests for mirrorlist from your organization's public IP, will be replied with the URL to the mirror in your LAN IP. Your users won't know that they are using a LAN mirror! It JustWorks!. This is something APT won't give you :P. You can also set your mirrors to be available to certain range of IP/countries or not.<br /><br /><b>Tips 9: Detect problems early. Use package-cleanup</b><br /><br />Sometimes, you might get your installation interrupted or some crazy happening which your installed package database goes crazy with duplicate packages or broken dependencies. There is one tool which helps a lot in tracing the problem and its called package-cleanup. This tool is provided by the yum-utils package, so to acquire it, <br /><br /><code> yum install yum-utils</code><br /><br />Several common commands I usually use:<br /><br /><code>package-cleanup --dupes # list out duplicates<br />package-cleanup --cleandupes # clean up duplicates<br />package-cleanup --problems # list out packages with broken dependencies</code><br /><br />More options? .. invoke the --help parameter<br /><br /><b>Tips 10: Download packages for usage later, together with dependencies</b><br /><br />Sometime, you might want to download packages with its dependencies but without installing it and you want to have it easily copyable to another computer with exactly the same installed package list with your computer. yumdownloader (provided by yum-utils package) tool is great for this. You can use it to, for example, build reusable packs for a bunch of identical computers, and distribute them. You can also use it for grabbing the source rpm of a package, just in case you want to hack some stuff from the package.<br /><br />My usual use of yumdownloader:<br /><br /><code><br /># download source package<br />yumdownloader --source packagename <br /><br /># download a package, together with <br /># dependencies needed on my computer<br />yumdownloader --resolve packagename<br /><br /># download a package, together with <br /># dependencies needed on a different<br /># chroot/mounted Fedora install <br />yumdownloader --resolve packagename --root /path/to/chroot<br /></code><br /><br />Theres another trick of using the yumdownloader with chroot, by copying /var/lib/rpm folder, you can make use of the rpm profile to download packages for a friend's computer and pass it in a CD. This concept is what being used in opyum (a similar tool like APTonCD) to build what debarashi call as YumPacks. Opyum is cool, but somehow I feel creating the set manually is more comfortable for me. Telling a user to pass me the /var/lib/rpm folder is much easier and quicker rather than telling them to install opyum and guide them through how to create a profile. Though, that is my personal preference, opyum is still a great tool to use for "users" who don't know how to mess with the CLI tricks.<br /><br /><b>Tips 11: Clean caches first if somehow yum behave weirdly</b><br /><br />Sometimes the files cached in your computer might be broken because of some reason or another (I usually getting this problem in my university, with my hackish Fedora repository mirror - so, the metadata tend to be a crazy broken metadata once in a while). Try cleaning the cache first and retry. Chances are the problem is from there. To clean whatever cached files in your yum cache, use:<br /><br /><code>yum clean all</code><br /><br /><b>Tips 12: When yum fails miserably for everything, fear not, APT and Smart are there to save the day</b><br /><br />Fedora have APT too!!!. Those from debian roots who can't seem to get away from APT, just install apt-rpm. You'll get your familiar package manager again~ :D. Another available package manager for Fedora is smart.<br /><br />One beauty about apt-rpm and smart on Fedora, they all uses the generic repository metadata similar to yum. That means, all yum repositories will work with apt-rpm and smart effortlessly!. Nice eh?. hehe<br /><br /><b>EOTipsList</b><br /><br />Thats all the tips that I can recall during the writing of this post. I might have other tricks behind my head somewhere, but could not recall it at this moment. The only next time I might remember it is when I faced a problem which made me recalled it.<br /><br />Enjoy with yum. Its a fun, yummy package manager once you get the hang of it. A final tips, not useful for "users", but useful for python hackers, Yum plugins are easy to write, and it can make use any python libraries. If you need a particular special-case feature for your own use, you can get more information how to write your own custom plugin here: <a href="http://wiki.linux.duke.edu/WritingYumPlugins">http://wiki.linux.duke.edu/WritingYumPlugins</a>. I myself wrote one hackish plugin for people in my university to get to my repository. My university network layout and restrictions sucks bigtime, so, I had to write something to automatically create a tunnel to my repository and let users yum through the tunnel - seamlessly. The users doesn't even need to learn how to tunnel, it JustWorks.<br /><br />Have Fun~ :D<div class="blogger-post-footer"><br/>
<br/>
- Izhar Firdaus -</div>