---
author: kagesenshi
blogger_id: tag:blogger.com,1999:blog-28371165.post-8140593018096370410
blogger_orig_url: https://blog.kagesenshi.org/2012/07/plone-cartridge-for-deployment-on.html
categories:
- old blog
date: '2012-07-23T05:32:00.000+08:00'
layout: post
modified_time: '2012-07-24T05:38:42.677+08:00'
tags:
- Linux
- Grok
- OpenShift
- Inigo
- PlanetPlone
- Buildout
- Tools
- PlanetFedora
- Open Source
- Hacks
- Framework
- Plone
- Cloud
- Zope
title: Plone cartridge for deployment on OpenShift
---

<div dir="ltr" style="text-align: left;" trbidi="on">I was poking around <a href="https://openshift.redhat.com/">OpenShift</a> on last weekend to see what it offers, and also to see whether I can deploy Plone on it.<br /><br />TLDR; Plone deploys well on my OpenShift VM. I created a cartridge for it here: <a href="https://github.com/kagesenshi/cartridge-plone">https://github.com/kagesenshi/cartridge-plone</a> . I can now easily add new Plone deployments for my development server with less work.<br /><br /><b>About OpenShift</b><br /><br />OpenShift is a Platform as a Service (PaaS) software from Red Hat. It can be summarized as a FOSS <a href="http://www.heroku.com/">Heroku</a>-like platform for deploying web applications easily. <br /><br />Support for applications comes in 'cartridges', which basically a set of files and scripts to prepare a self-contained environment for your application deployment. OpenShift includes several official cartridges to deploy popular applications and frameworks such as Drupal, RoR, Django, WSGI, etc. There is also a cartridge called 'DIY' which allows you to import any http daemon and serve it through OpenShift - thus providing a basic way in integrating non-officially supported frameworks.<br /><br /><b>Plone on OpenShift</b><br /><br />Due to Plone is rather huge and also the uncertainty on what the kind of problems I might face trying to deploy Plone in <a href="http://openshift.redhat.com/">openshift.redhat.com</a>, I created my own private OpenShift server following this guide <a href="https://openshift.redhat.com/community/wiki/build-your-own-paas-from-the-openshift-origin-livecd-using-liveinst">https://openshift.redhat.com/community/wiki/build-your-own-paas-from-the-openshift-origin-livecd-using-liveinst</a>. At least this way, I have easy access to the server to inspect codes and error logs when things does not work.<br /><br />Afterwards I went digging and experimenting on existing cartridges to understand how things work (Official doc: <a href="https://openshift.redhat.com/community/wiki/introduction-to-cartridge-building">https://openshift.redhat.com/community/wiki/introduction-to-cartridge-building</a>) and derived the first plone cartridge using bits from python-2.6 and diy-0.1 cartridges.<br /><br />After hours of experimenting and hacking around, the plone cartridge is fully functional to deploy basic Plone site. With the cartridge installed, I can now easily add new single instance Plone sites with just this command:<br /><br /><pre><code>rhc app create -t plone-4.2 -a myplonesite </code></pre><br /><b>The cartridge</b><br /><br />I have uploaded the Plone cartridge code here: <a href="https://github.com/kagesenshi/cartridge-plone">https://github.com/kagesenshi/cartridge-plone</a> .&nbsp;Follow the readme on how to build the RPM and install it into your OpenShift server. There is one annoyance though; the cartridge list is apparently hardcoded into a ruby file, making it somewhat annoying to automate the final step of the installation (would be nice if theres a config file for this, and ruby is like perl to me - difficult to read when the dev uses the language fully). So remember to follow the guide on adding your cartridge into the code and reload the cache.<br /><br />Do check it out ^-^<br /><br /><b>The good and the not-so-nice</b><br /><ul style="text-align: left;"><li>The cartridge works pretty well in deploying new basic plone site</li><li>Building new cartridge is easy and straightforward</li><li>Many Plone deployment in one server and they are not fighting for port/address - WIN!</li><li>The automatic DNS configuration is very neat - especially the 'add-alias' command.&nbsp;</li><li>The Plone cartridge have been configured to share download-cache, but I'm not sure on the security implication.</li><li>Looking at how things are deployed, it made me wonder on security of a multi-user, non-private openshift server. How does one know that an app won't mess with the filesystem. Or is this using SELinux?, If yes, what are the stuff allowed,and what are not?. </li><li>Due to some security concern and possible umask/permission problem, I did not configure eggs-directory to be shared. This affects the speed of deployment, and you lose your eggs directory when you destroy an app. New apps will have to rebuild its eggs cache.</li><li>There is a 'snapshot' command which allows you to download your data, however I'm not sure how reliable it is for large data. </li><li>Instance is stopped and buildout is re-run for every git push and also when doing snapshot. This can cause downtime for sites. For snapshots, it would be nice if theres a way to rsync without stopping the instance.</li><li>The 'tail' command (tails the log) is cool.&nbsp;</li><li>The 'tidy' command and hook looks useful, perhaps to do zeopack and log shortening. The cartridge yet to have any feature related to this.&nbsp;</li><li>'/health'&nbsp; URL is reserved by OpenShift to check whether the site is up, no idea whether this can be changed to something thats harder to clash (eg: openshift-health or something)</li><li>I'm not sure whether it is possible, or allowed to run <a href="http://buildout.org/">buildout</a> using the DIY cartridge on <a href="http://openshift.redhat.com/">openshift.redhat.com</a>. If it can be done, then this cartridge can be simplified to hooks for the DIY cartridge.</li><li>Perhaps I should create a Plone+ZEO cluster cartridges later, so that this become more scalable.</li><li>It would also be super cool if this cartridge could become part of the standard offering in <a href="http://openshift.redhat.com/">openshift.redhat.com</a>. In the meantime, I shall use it in <a href="http://www.inigo-tech.com/">Inigo</a>'s internal test server (or perhaps offer this as proper host later once it easily installable through EPEL or something)</li></ul><br /><b>UPDATE</b>: You can now deploy Plone on OpenShift using the DIY cartridge. Check out this post: <a href="http://blog.kagesenshi.org/2012/07/plone-on-openshift-quickstart-using-diy.html">http://blog.kagesenshi.org/2012/07/plone-on-openshift-quickstart-using-diy.html</a><br /><ul style="text-align: left;"></ul></div><div class="blogger-post-footer"><br/>
<br/>
- Izhar Firdaus -</div>